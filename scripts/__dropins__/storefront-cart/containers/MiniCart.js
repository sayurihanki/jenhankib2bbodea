/*! Copyright 2026 Adobe
All Rights Reserved. */
import{jsx as e,jsxs as d,Fragment as B}from"@dropins/tools/preact-jsx-runtime.js";import{useState as O,useEffect as j,useCallback as V}from"@dropins/tools/preact-compat.js";import{classes as h,VComponent as o,Slot as _}from"@dropins/tools/lib.js";import{g as Y}from"../chunks/persisted-data.js";import{events as $}from"@dropins/tools/event-bus.js";import{Button as T,Price as k}from"@dropins/tools/components.js";/* empty css                        */import{useText as P}from"@dropins/tools/i18n.js";import"@dropins/tools/preact-hooks.js";import{s as f}from"../chunks/resetCart.js";import{a as q}from"../chunks/acdl.js";import{u as z}from"../chunks/updateProductsFromCart.js";import"../chunks/CartSummaryGrid.js";import{C as J}from"../chunks/CartSummaryList.js";import"../chunks/OrderSummary.js";import"../chunks/CartSummaryTable2.js";import"@dropins/tools/fetch-graphql.js";import"../chunks/refreshCart.js";import"../fragments.js";import"../chunks/EmptyCart2.js";import"../chunks/createGuestCart.js";import"../chunks/WarningWithCircle.js";import"../chunks/ChevronDown.js";import"../chunks/getEstimatedTotals.js";import"../chunks/OrderSummaryLine.js";import"../chunks/ChevronUp.js";import"../chunks/Coupon.js";import"../chunks/GiftCard.js";import"../chunks/EmptyCart.js";import"../chunks/Close.js";const K=({className:x,products:p,productListFooter:b,subtotal:t,subtotalExcludingTaxes:I,preCheckoutSection:m,ctas:a,...l})=>{const y=P({subtotal:"Cart.MiniCart.subtotal",subtotalExcludingTaxes:"Cart.MiniCart.subtotalExcludingTaxes"});return e("div",{...l,className:h(["cart-mini-cart",x]),children:p&&d(B,{children:[e("div",{className:"cart-mini-cart__products","data-testid":"mini-cart-products-wrapper",children:p}),b&&e("div",{className:h(["cart-mini-cart__productListFooter"]),"data-testid":"mini-cart-product-list-footer",children:e(o,{node:b})}),d("div",{className:"cart-mini-cart__footer","data-testid":"mini-cart-subtotals",children:[t&&d("div",{className:"cart-mini-cart__footer__estimated-total","data-testid":"mini-cart-subtotal",children:[y.subtotal,e(o,{node:t})]}),I&&d("div",{className:"cart-mini-cart__footer__estimated-total-excluding-taxes","data-testid":"mini-cart-subtotal-excluding-taxes",children:[y.subtotalExcludingTaxes,e(o,{node:I,className:h(["dropin-price-summary__price","dropin-price-summary__price--muted"])})]}),m&&e("div",{className:h(["cart-mini-cart__preCheckoutSection"]),"data-testid":"mini-cart-pre-checkout-section",children:e(o,{node:m})}),a&&e(o,{node:a,className:"cart-mini-cart__footer__ctas"})]})]})})},W=100,Z=({children:x,initialData:p=null,hideFooter:b=!0,slots:t,routeProduct:I,routeCart:m,routeCheckout:a,routeEmptyCartCTA:l,showDiscount:y,showSavings:S,enableItemRemoval:D=!0,enableQuantityUpdate:A=!1,hideHeading:F=!1,undo:Q=!1,...U})=>{var C,L,N;const[i,E]=O(p),n=(C=f.config)==null?void 0:C.shoppingCartDisplaySetting;j(()=>{const r=$.on("cart/data",c=>{E(c)},{eager:!0});return()=>{r==null||r.off()}},[]);const g=P({cartLink:"Cart.MiniCart.cartLink",checkoutLink:"Cart.MiniCart.checkoutLink"}),v=(r,c)=>z([{uid:r,quantity:c}]),M=r=>v(r,0),u=i==null?void 0:i.hasOutOfStockItems,R=V(r=>{i&&!u&&(r.preventDefault(),q(i,f.locale),setTimeout(()=>{const c=a==null?void 0:a();c&&(window.location.href=c)},W))},[i,u,a]),w=e(_,{name:"ProductList",slot:t==null?void 0:t.ProductList,context:{itemQuantityUpdateHandler:v,itemRemoveHandler:M,totalQuantity:i==null?void 0:i.totalQuantity},children:e(J,{"data-testid":"default-cart-summary-list",routeProduct:I,routeEmptyCartCTA:l,initialData:i,maxItems:(L=f.config)==null?void 0:L.miniCartMaxItemsDisplay,showMaxItems:!!((N=f.config)!=null&&N.miniCartMaxItemsDisplay),hideHeading:F||!(i!=null&&i.totalQuantity),hideFooter:b,enableRemoveItem:D,enableUpdateItemQuantity:A,showDiscount:y,showSavings:S,undo:Q,slots:{Thumbnail:t==null?void 0:t.Thumbnail,Heading:t==null?void 0:t.Heading,EmptyCart:t==null?void 0:t.EmptyCart,Footer:t==null?void 0:t.Footer,RowTotalFooter:t==null?void 0:t.RowTotalFooter,ProductAttributes:t==null?void 0:t.ProductAttributes,CartSummaryFooter:t==null?void 0:t.CartSummaryFooter,CartItem:t==null?void 0:t.CartItem,UndoBanner:t==null?void 0:t.UndoBanner,ItemTitle:t==null?void 0:t.ItemTitle,ItemPrice:t==null?void 0:t.ItemPrice,ItemQuantity:t==null?void 0:t.ItemQuantity,ItemTotal:t==null?void 0:t.ItemTotal,ItemSku:t==null?void 0:t.ItemSku,ItemRemoveAction:t==null?void 0:t.ItemRemoveAction}})}),G=r=>e(_,{name:"ProductListFooter",slot:t==null?void 0:t.ProductListFooter,context:{data:r}}),H=r=>e(_,{name:"PreCheckoutSection",slot:t==null?void 0:t.PreCheckoutSection,context:{data:r}}),X=()=>(n==null?void 0:n.subtotal)==="INCLUDING_TAX"||(n==null?void 0:n.subtotal)==="INCLUDING_EXCLUDING_TAX"?{amount:i==null?void 0:i.subtotal.includingTax.value,currency:i==null?void 0:i.subtotal.includingTax.currency,"data-testid":"subtotal-including-tax",style:{font:"inherit"}}:{amount:i==null?void 0:i.subtotal.excludingTax.value,currency:i==null?void 0:i.subtotal.excludingTax.currency,"data-testid":"subtotal-excluding-tax",style:{font:"inherit"}};return e(K,{...U,productListFooter:G(i),subtotal:i!=null&&i.totalQuantity?(i==null?void 0:i.subtotal)&&e(k,{...X()}):void 0,subtotalExcludingTaxes:i!=null&&i.totalQuantity?(i==null?void 0:i.subtotal)&&((n==null?void 0:n.subtotal)==="INCLUDING_EXCLUDING_TAX"?e(k,{amount:i==null?void 0:i.subtotal.excludingTax.value,currency:i==null?void 0:i.subtotal.excludingTax.currency,"data-testid":"subtotal-including-excluding-tax",style:{font:"inherit"}}):void 0):void 0,preCheckoutSection:H(i),ctas:i!=null&&i.totalQuantity?d("div",{children:[a&&e(T,{"data-testid":"route-checkout-button",variant:"primary",href:u?void 0:a(),disabled:u,"aria-disabled":u,onClick:R,children:g.checkoutLink}),m&&e(T,{"data-testid":"route-cart-button",variant:"tertiary",href:m(),children:g.cartLink})]}):void 0,products:w})};Z.getInitialData=async function(){return Y()};export{Z as MiniCart,Z as default};
//# sourceMappingURL=MiniCart.js.map
